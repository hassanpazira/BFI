<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="MAP.estimation function is used (in local centers) to compute Maximum A Posterior (MAP) estimators of the parameters for Generalized Linear Models (GLM) and Survival models."><title>Maximum A Posteriori estimation — MAP.estimation • BFI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum A Posteriori estimation — MAP.estimation"><meta property="og:description" content="MAP.estimation function is used (in local centers) to compute Maximum A Posterior (MAP) estimators of the parameters for Generalized Linear Models (GLM) and Survival models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary" data-bs-theme="default"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BFI</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BFI.html">An Introduction to BFI</a>
    <a class="dropdown-item" href="../articles/Python.html">Calling BFI from Python</a>
    <a class="dropdown-item" href="../articles/SAS.html">Using BFI in SAS</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hassanpazira/BFI">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Maximum A Posteriori estimation</h1>
      
      <div class="d-none name"><code>MAP.estimation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>MAP.estimation</code> function is used (in local centers) to compute Maximum A Posterior (MAP) estimators of the parameters for Generalized Linear Models (GLM) and Survival models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span>, <span class="st">"cox"</span><span class="op">)</span>,</span>
<span>               <span class="va">Lambda</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>, initial <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"poly"</span>,<span class="st">"exp"</span>,<span class="st">"weibul"</span>,<span class="st">"gomp"</span>,<span class="st">"pwexp"</span><span class="op">)</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.1</span>, max_order <span class="op">=</span> <span class="fl">2</span>, n_intervals <span class="op">=</span> <span class="fl">4</span>,</span>
<span>               min_max_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>,<span class="st">"max"</span><span class="op">)</span>,</span>
<span>               center_zero_sample <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">zero_sample_cov</span>,</span>
<span>               <span class="va">refer_cat</span>, <span class="va">zero_cat</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>y</dt>
<dd><p>response vector. If the “<code>binomial</code>” family is used, this argument is a vector with entries 0 (failure) or 1 (success). Alternatively, for this family, the response can be a matrix where the first column is the number of “successes” and the second column is the number of “failures”. For the “<code>cox</code>” family, the response is a matrix where the first column is the survival time, named “time”, and the second column is the censoring indicator, named “status”, with \(0\) indicating censored and \(1\) indicating event time.</p></dd>


<dt>X</dt>
<dd><p>design matrix of dimension \(n \times p\), where \(p\) is the number of covariables or predictors.</p></dd>


<dt>family</dt>
<dd><p>a description of the error distribution and link function used to specify the model. This can be a character string naming a family function or the result of a call to a family function (see <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> for details). In the current version of the package, the family of model can be <code>gaussian</code> (with <code>identity</code> link function) and <code>binomial</code> (with <code>logit</code> link function). By default the <code>gaussian</code> family is used. In case of a linear regression model, <code>family = gaussian</code>, there is an extra model parameter for the variance of measurement error.</p></dd>


<dt>Lambda</dt>
<dd><p>the inverse variance-covariance matrix of the Gaussian distribution that is used as prior distribution for the model parameters. The dimension of the matrix depends on the number of columns of <code>X</code>, type of the covariates (continuous / dichotomous or categorical), <code>family</code>, and <code>intercept</code>. However, <code>Lambda</code> can be easily created by <code><a href="inv.prior.cov.html">inv.prior.cov()</a></code>.</p></dd>


<dt>intercept</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>initial</dt>
<dd><p>a vector specifying initial values for the parameters to be optimized over. The length of <code>initial</code> is equal to the number of model parameters and thus, is equal to the number of rows or columns of <code>Lambda</code>.
Since the <code>'L-BFGS-B'</code> method is used in the algorithm, these values should always be finite. Default is a vector of zeros.</p></dd>


<dt>model</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>alpha</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>max_order</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>n_intervals</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>min_max_time</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>center_zero_sample</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>zero_sample_cov</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>refer_cat</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>zero_cat</dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept=FALSE</code> it is set to zero, i.e., it's not in the model.</p></dd>


<dt>control</dt>
<dd><p>a list of control parameters. See ‘Details’.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    


<p><code>MAP.estimation</code> returns a list containing the following components:</p>
<dl><dt>theta_hat</dt>
<dd><p>the vector corresponding to the maximum a posteriori (MAP) estimates of the parameters;</p></dd>


<dt>A_hat</dt>
<dd><p>minus the curvature (or Hessian) matrix around the point <code>theta_hat</code>. The dimension of the matrix is the same as the argument <code>Lambda</code>;</p></dd>


<dt>sd</dt>
<dd><p>the vector of standard deviation of the MAP estimates in <code>theta_hat</code>, that is <code>sqrt(diag(solve(A_hat)))</code>;</p></dd>


<dt>Lambda</dt>
<dd><p>the inverse variance-covariance matrix of the Gaussian distribution that is used as prior distribution for the parameters. It's exactly the same as the argument <code>Lambda</code>;</p></dd>


<dt>formula</dt>
<dd><p>the formula applied;</p></dd>


<dt>names</dt>
<dd><p>the names of the model parameters;</p></dd>


<dt>n</dt>
<dd><p>sample size;</p></dd>


<dt>np</dt>
<dd><p>the number of coefficients;</p></dd>


<dt>value</dt>
<dd><p>the value of minus the log-likelihood posterior density evaluated at <code>theta_hat</code>;</p></dd>


<dt>family</dt>
<dd><p>the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> object used.;</p></dd>


<dt>intercept</dt>
<dd><p>logical flag used to fit an intercept if <code>TRUE</code>, or set to zero if <code>FALSE</code>;</p></dd>


<dt>convergence</dt>
<dd><p>an integer value used to encode the warnings and the errors related
to the algorithm used to fit the model. The values returned are:</p><dl><dt>0</dt>
<dd><p>algorithm has converged;</p></dd>


		<dt>1</dt>
<dd><p>maximum number of iterations ('<code>maxit</code>') has been reached;</p></dd>


		<dt>2</dt>
<dd><p>Warning from the 'L-BFGS-B' method. See the message after this value;</p></dd>

	
</dl></dd>


<dt>control</dt>
<dd><p>the list of control parameters used to compute the MAP estimates.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>MAP.estimation</code> function finds the Maximum A Posteriori (MAP) estimates of the model parameters by maximizing the log-posterior density with respect to the parameters, i.e., the estimates equal the values for which the log-posterior density is maximal (the posterior mode).
In other words, <code>MAP.estimation()</code> optimizes the log-posterior density with respect to the parameter vector to obtain its MAP estimates.
In addition to the model parameters, i.e., coefficients (\({\beta}\)'s) and variance error (\(\sigma^2_e\)), the curvature matrix (Hessian of the log-posterior) is estimated around the mode.</p>
<p>The <code>MAP.estimation</code> function returns an object of class `<code>bfi</code>`. Therefore, <code><a href="summary.bfi.html">summary()</a></code> can be used for the object returned by <code>MAP.estimation()</code>.</p>
<p>To solve unconstrained and bound-constrained optimization problems, the <code>MAP.estimation</code> function utilizes an optimization algorithm called Limited-memory Broyden-Fletcher-Goldfarb-Shanno with Bound Constraints (L-BFGS-B), Byrd et. al. (1995).
The L-BFGS-B algorithm is a limited-memory “quasi-Newton” method that iteratively updates the parameter estimates by approximating the inverse Hessian matrix using gradient information from the history of previous iterations. This approach allows the algorithm to approximate the curvature of the posterior distribution and efficiently search for the optimal solution, which makes it computationally efficient for problems with a large number of variables.</p>
<p>By default, the algorithm uses a relative change in the objective function as the convergence criterion. When the change in the objective function between iterations falls below a certain threshold (`<code>factr</code>`) the algorithm is considered to have converged.
The convergence can be checked with the argument <code>convergence</code> in the output. See ‘Value’.</p>
<p>In case of convergence issue, it may be necessary to investigate and adjust optimization parameters to facilitate convergence. It can be done using the <code>initial</code> and <code>control</code> arguments. By the argument <code>initial</code> the initial points of the interative optimization algorithm can be changed, and the argument <code>control</code> is a list that can supply any of the following components:</p>
<dl><dt><code>maxit</code>:</dt>
<dd><p>is the maximum number of iterations. Default is 100;</p></dd>


<dt><code>factr</code>:</dt>
<dd><p>controls the convergence of the <code>'L-BFGS-B'</code> method. Convergence occurs when the reduction in the objective is within this factor of the machine tolerance. Default for <code>factr</code> is 1e7, which gives a tolerance of about 1e-9. The exact tolerance can be checked by multiplying this value by <code>.Machine$double.eps</code>;</p></dd>


<dt><code>pgtol</code>:</dt>
<dd><p>helps to control the convergence of the <code>'L-BFGS-B'</code> method. It is a tolerance on the projected gradient in the current search direction, i.e., the iteration will stop when the maximum component of the projected gradient is less than or equal to <code>pgtol</code>, where <code>pgtol</code>\(\geq 0\). Default is zero, when the check is suppressed;</p></dd>


<dt><code>trace</code>:</dt>
<dd><p>is a non-negative integer. If positive, tracing information on the progress of the optimization is produced. Higher values may produce more tracing information: for the method <code>'L-BFGS-B'</code> there are six levels of tracing. To understand exactly what these do see the source code of <code>optim</code> function in the <span class="pkg"><a href="https://rdrr.io/r/stats/stats-package.html" class="external-link">stats</a></span> package;</p></dd>


<dt><code>REPORT</code>:</dt>
<dd><p>is the frequency of reports for the <code>'L-BFGS-B'</code> method if <code>'control$trace'</code> is positive. Default is every 10 iterations;</p></dd>


<dt><code>lmm</code>:</dt>
<dd><p>is an integer giving the number of <code>BFGS</code> updates retained in the <code>'L-BFGS-B'</code> method. Default is 5.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jonker M.A., Pazira H. and Coolen A.C.C. (2024). <em>Bayesian federated inference for estimating statistical models based on non-shared multicenter data sets</em>, <em>Statistics in Medicine</em>, 43(12): 2421-2438. &lt;https://doi.org/10.1002/sim.10072&gt;</p>
<p>Byrd R.H., Lu P., Nocedal J. and Zhu C. (1995). <em>A limited memory algorithm for bound constrained optimization</em>. SIAM Journal on Scientific Computing, 16, 1190-1208. &lt;https://doi.org/10.1137/0916069&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Hassan Pazira<br>
Maintainer: Hassan Pazira <a href="mailto:hassan.pazira@radboudumc.nl">hassan.pazira@radboudumc.nl</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="BFI.html">bfi</a></code>, <code><a href="inv.prior.cov.html">inv.prior.cov</a></code> and <code><a href="summary.bfi.html">summary.bfi</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">###--------------###</span></span></span>
<span class="r-in"><span><span class="co">### y ~ Gaussian ###</span></span></span>
<span class="r-in"><span><span class="co">###--------------###</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setting a seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11235</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model assumption:</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>  <span class="co"># model parameters: coefficients and sigma2 = 1.5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------</span></span></span>
<span class="r-in"><span><span class="co"># Data Simulation</span></span></span>
<span class="r-in"><span><span class="co">#----------------</span></span></span>
<span class="r-in"><span><span class="va">n</span>   <span class="op">&lt;-</span> <span class="fl">30</span>   <span class="co"># sample size</span></span></span>
<span class="r-in"><span><span class="va">p</span>   <span class="op">&lt;-</span> <span class="fl">3</span>    <span class="co"># number of coefficients without intercept</span></span></span>
<span class="r-in"><span><span class="va">X</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="co"># continuous variables</span></span></span>
<span class="r-in"><span><span class="co"># linear predictor:</span></span></span>
<span class="r-in"><span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">$</span><span class="va">X1</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">$</span><span class="va">X2</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">$</span><span class="va">X3</span></span></span>
<span class="r-in"><span><span class="co"># inverse of the link function ( g^{-1}(\eta) = \mu ):</span></span></span>
<span class="r-in"><span><span class="va">mu</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#---------------------</span></span></span>
<span class="r-in"><span><span class="co"># Load the BFI package</span></span></span>
<span class="r-in"><span><span class="co">#---------------------</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hassanpazira.github.io/BFI/">BFI</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># MAP estimations for theta and curvature matrix</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># MAP estimates with 'intercept'</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, <span class="va">Lambda</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $theta_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          X1          X2          X3      sigma2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1.341252    2.236396    2.070999    2.164007    1.054574 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $A_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)         X1         X2         X3     sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  28.5475061  1.9315684 -7.7385576  6.2804398 -0.2685067</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1            1.9315684 20.4368732 -2.2127201  4.5673160 -0.4469901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2           -7.7385576 -2.2127201 49.3205512  3.1359265 -0.4141859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3            6.2804398  4.5673160  3.1359265 24.3657264 -0.4325768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2       -0.2685067 -0.4469901 -0.4141859 -0.4325768 64.2182264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          X1          X2          X3      sigma2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.1982979   0.2269486   0.1476577   0.2153271   0.1248067 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)  X1  X2  X3 sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)         0.1 0.0 0.0 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1                  0.0 0.1 0.0 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2                  0.0 0.0 0.1 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3                  0.0 0.0 0.0 0.1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2              0.0 0.0 0.0 0.0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] y ~ X1 + X2 + X3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "(Intercept)" "X1"          "X2"          "X3"          "sigma2"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $np</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $q_l</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $theta_A_ploy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $levs_no_ref_no_zer_poly</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 35.28046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gaussian"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $intercept</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bfi"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bfi"</span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: y ~ X1 + X2 + X3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘gaussian’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Link: ‘identity’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   1.3413  0.1983  0.9526   1.7299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1            2.2364  0.2269  1.7916   2.6812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2            2.0710  0.1477  1.7816   2.3604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3            2.1640  0.2153  1.7420   2.5860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion parameter (sigma2):  1.055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             log Lik Posterior:  -35.28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)      X1      X2      X3  sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     28.5475  1.9316 -7.7386  6.2804 -0.2685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1               1.9316 20.4369 -2.2127  4.5673 -0.4470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2              -7.7386 -2.2127 49.3206  3.1359 -0.4142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3               6.2804  4.5673  3.1359 24.3657 -0.4326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2          -0.2685 -0.4470 -0.4142 -0.4326 64.2182</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># MAP estimates without 'intercept'</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">'gaussian'</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">'gaussian'</span>, <span class="va">Lambda</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $theta_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       X1       X2       X3   sigma2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.241636 1.832739 2.525240 2.496088 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $A_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                X1         X2         X3     sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      8.6921396 -0.9348536  1.9296485 -0.4483286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     -0.9348536 20.8952246  1.3248998 -0.3665815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      1.9296485  1.3248998 10.3520435 -0.5049495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2 -0.4483286 -0.3665815 -0.5049495 69.9845760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        X1        X2        X3    sigma2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3478795 0.2205606 0.3192962 0.1195751 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         X1  X2  X3 sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1     0.1 0.0 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     0.0 0.1 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3     0.0 0.0 0.1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2 0.0 0.0 0.0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] y ~ X1 + X2 + X3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "X1"     "X2"     "X3"     "sigma2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $np</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $q_l</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $theta_A_ploy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $levs_no_ref_no_zer_poly</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 63.9101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gaussian"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $intercept</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bfi"</span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit1</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: y ~ X1 + X2 + X3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘gaussian’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Link: ‘identity’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1   2.2416  0.3479  1.5598   2.9235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2   1.8327  0.2206  1.4004   2.2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3   2.5252  0.3193  1.8994   3.1510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion parameter (sigma2):  2.496 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             log Lik Posterior:  -63.91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             X1      X2      X3  sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      8.6921 -0.9349  1.9296 -0.4483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     -0.9349 20.8952  1.3249 -0.3666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      1.9296  1.3249 10.3520 -0.5049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2 -0.4483 -0.3666 -0.5049 69.9846</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###------------###</span></span></span>
<span class="r-in"><span><span class="co">### Cox family ###</span></span></span>
<span class="r-in"><span><span class="co">###------------###</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setting a seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">112358</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Simulated Survival data</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------</span></span></span>
<span class="r-in"><span><span class="va">n</span>    <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">p</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="co"># continuous (normal) variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulating survival dataset from Weibull with a predefined censoring rate of 0.3</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="surv.simulate.html">surv.simulate</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, beta <span class="op">=</span> <span class="va">beta</span>, a <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1.8</span><span class="op">)</span>, u1 <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                   cen_rate <span class="op">=</span> <span class="fl">0.3</span>, gen_data_from <span class="op">=</span> <span class="st">"weibul"</span><span class="op">)</span><span class="op">$</span><span class="va">D</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># MAP estimations</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">'gaussian'</span><span class="op">)</span> <span class="co"># 'cox'</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">'cox'</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>, model <span class="op">=</span> <span class="st">"weibul"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in MAP.estimation(y, X, family = "cox", Lambda = Lambda, model = "weibul"):</span> object 'theta_M_ql' not found</span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># 'cox'</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: y ~ X1 + X2 + X3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘gaussian’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Link: ‘identity’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   1.3413  0.1983  0.9526   1.7299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1            2.2364  0.2269  1.7916   2.6812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2            2.0710  0.1477  1.7816   2.3604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3            2.1640  0.2153  1.7420   2.5860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion parameter (sigma2):  1.055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             log Lik Posterior:  -35.28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)      X1      X2      X3  sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     28.5475  1.9316 -7.7386  6.2804 -0.2685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1               1.9316 20.4369 -2.2127  4.5673 -0.4470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2              -7.7386 -2.2127 49.3206  3.1359 -0.4142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3               6.2804  4.5673  3.1359 24.3657 -0.4326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2          -0.2685 -0.4470 -0.4142 -0.4326 64.2182</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># MAP estimates with ...</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, <span class="va">Lambda</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in model.frame.default(formula = formula, data = as.data.frame(X),     drop.unused.levels = TRUE):</span> invalid type (list) for variable 'y'</span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit1</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: y ~ X1 + X2 + X3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘gaussian’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Link: ‘identity’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1   2.2416  0.3479  1.5598   2.9235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2   1.8327  0.2206  1.4004   2.2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3   2.5252  0.3193  1.8994   3.1510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion parameter (sigma2):  2.496 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             log Lik Posterior:  -63.91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             X1      X2      X3  sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      8.6921 -0.9349  1.9296 -0.4483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     -0.9349 20.8952  1.3249 -0.3666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      1.9296  1.3249 10.3520 -0.5049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2 -0.4483 -0.3666 -0.5049 69.9846</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hassan Pazira, Emanuele Massa, Marianne A. Jonker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

