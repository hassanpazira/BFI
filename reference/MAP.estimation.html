<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximum A Posteriori estimation — MAP.estimation • BFI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum A Posteriori estimation — MAP.estimation"><meta name="description" content="MAP.estimation function is used (in local centers) to compute Maximum A Posterior (MAP) estimators of the parameters for Generalized Linear Models (GLM) and Survival models."><meta property="og:description" content="MAP.estimation function is used (in local centers) to compute Maximum A Posterior (MAP) estimators of the parameters for Generalized Linear Models (GLM) and Survival models."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BFI</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/BFI.html">An Introduction to BFI</a></li>
    <li><a class="dropdown-item" href="../articles/Python.html">Calling BFI from Python</a></li>
    <li><a class="dropdown-item" href="../articles/SAS.html">Using BFI in SAS</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/hassanpazira/BFI"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximum A Posteriori estimation</h1>

      <div class="d-none name"><code>MAP.estimation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>MAP.estimation</code> function is used (in local centers) to compute Maximum A Posterior (MAP) estimators of the parameters for Generalized Linear Models (GLM) and Survival models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>,</span>
<span>               <span class="va">X</span>,</span>
<span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"binomial"</span>, <span class="st">"survival"</span><span class="op">)</span>,</span>
<span>               <span class="va">Lambda</span>,</span>
<span>               intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               basehaz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weibul"</span>, <span class="st">"exp"</span>, <span class="st">"gomp"</span>, <span class="st">"poly"</span>, <span class="st">"pwexp"</span>, <span class="st">"unspecified"</span><span class="op">)</span>,</span>
<span>               treatment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               treat_round <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               <span class="va">refer_treat</span>,</span>
<span>               gamma_bfi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               RCT_propens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               initial <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>               max_order <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               n_intervals <span class="op">=</span> <span class="fl">4</span>,</span>
<span>               <span class="va">min_max_times</span>,</span>
<span>               center_zero_sample <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               <span class="va">zero_sample_cov</span>,</span>
<span>               <span class="va">refer_cat</span>,</span>
<span>               <span class="va">zero_cat</span>,</span>
<span>               control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>



<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>response vector. If the “<code>binomial</code>” family is used, this argument is a vector with entries 0 (failure) or 1 (success). Alternatively, for this family, the response can be a matrix where the first column is the number of “successes” and the second column is the number of “failures”. For the “<code>survival</code>” family, the response is a matrix where the first column is the survival time, named “time”, and the second column is the censoring indicator, named “status”, with 0 indicating censoring time and 1 indicating event time.</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>design matrix of dimension \(n_{\ell} \times p\), where \(p\) is the number of covariates or predictors and \(n_{\ell}\) is the number of indeviduals in the local center. If there is a categorical covariate, then the function <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> should be used to encode the covariate as a factor. Note that the order of the covariates must be the same across the centers; otherwise, the output estimates of <code><a href="BFI.html">bfi()</a></code> will be incorrect.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>a description of the error distribution. This is a character string naming a family of the model. In the current version of the package, the family of model can be “<code>gaussian</code>” (with <code>identity</code> link function), dQuote<code>binomial</code> (with <code>logit</code> link function), or “<code>survival</code>”. Can be abbreviated. By default the “<code>gaussian</code>” family is used. In case of a linear regression model, <code>family = "gaussian"</code>, there is an extra model parameter for the variance of measurement error. While in the case of survival model, <code>family = "survival"</code>, the number of the model parameters depend on the choice of baseline hazard functions, see ‘Details’ for more information.</p></dd>


<dt id="arg-lambda">Lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>the inverse variance-covariance matrix of the Gaussian distribution that is used as prior distribution for the model parameters. The dimension of the matrix depends on the number of columns of <code>X</code>, type of the covariates (continuous / dichotomous or categorical), <code>family</code>, and whether an <code>intercept</code> is included (if applicable). However, <code>Lambda</code> can be easily created by <code><a href="inv.prior.cov.html">inv.prior.cov()</a></code>. See <code><a href="inv.prior.cov.html">inv.prior.cov</a></code> for more information.</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>logical flag for fitting an intercept. If <code>intercept=TRUE</code> (the default), the intercept is fitted, i.e., it is included in the model, and if <code>intercept = FALSE</code> it is set to zero, i.e., it's not in the model. This argument is not used if <code>family = "survival"</code>.</p></dd>


<dt id="arg-basehaz">basehaz<a class="anchor" aria-label="anchor" href="#arg-basehaz"></a></dt>
<dd><p>a character string representing one of the available baseline hazard functions; <code>exponential</code> (“<code>exp</code>”), <code>Weibull</code> (“<code>weibul</code>”, the default), <code>Gompertz</code> (“<code>gomp</code>”), <code>exponentiated polynomial</code> (“<code>poly</code>”), <code>piecewise constant exponential</code> (“<code>pwexp</code>”), and <code>unspecified baseline hazard</code> (“<code>unspecified</code>”). Can be abbreviated. It is used only when <code>family = "survival"</code>. If local sample size is large and the shape of the baseline hazard function is completely unknown, the “exponentiated polynomial” and “piecewise exponential” hazard functions would be preferred above the lower dimensional alternatives. However, if the local samples size is low, one should be careful using the “piecewise exponential” hazard function with many intervals. If <code>basehaz = "unspecified"</code>, it means that a (semi-parametric) Cox model is considered, and the parameters (regression coefficients) are estimated using the partial log-likelihood. If <code>treatment</code> is not <code>NULL</code>, then <code>basehaz</code> must be set to <code>"unspecified"</code>, as the regression coefficients are estimated using the weighted partial log-likelihood.</p></dd>


<dt id="arg-treatment">treatment<a class="anchor" aria-label="anchor" href="#arg-treatment"></a></dt>
<dd><p>a character string representing the name or place of the binary covariate, respectively. This covariate indicates whether the patient got the new treatment (\(z_{\ell i}=1\)) or the placebo/standard treatment (\(z_{\ell i}=0\)). The treatment effect is estimated when this argument is NOT '<code>NULL</code>'. If it is set to '<code>NULL</code>' (the default), the treatment effect will not be estimated. For both the first and second rounds, it should not be '<code>NULL</code>'. See ‘Details’.</p></dd>


<dt id="arg-treat-round">treat_round<a class="anchor" aria-label="anchor" href="#arg-treat-round"></a></dt>
<dd><p>a character string representing the <code>'first'</code> or <code>'second'</code> round of estimating treatment effects. In the first round, <code>treat_round = 'first'</code>, the local estimates of the coefficients (\(\gamma_{\ell}\)) is estimated. In the second round, <code>treat_round = 'second'</code>, the <code>propensity</code> scores and the statistical summaries (<code>for_ATE</code>) are calculated to be sent to the central server for estimating the average treatment effects.</p></dd>


<dt id="arg-refer-treat">refer_treat<a class="anchor" aria-label="anchor" href="#arg-refer-treat"></a></dt>
<dd><p>a character string representing the reference category of the treatment variable. The reference category is considered as \(z_{\ell i}=0\). This argument is used when <code>treatment</code> is not '<code>NULL</code>'. Default is <code>refer_treat = levels(X$treatment)[1]</code>.</p></dd>


<dt id="arg-gamma-bfi">gamma_bfi<a class="anchor" aria-label="anchor" href="#arg-gamma-bfi"></a></dt>
<dd><p>a vector specifying the BFI estimates of the coefficients received from the central server in the first round. It can be defined by the output of <code>MAP.estimation()$theta_hat</code> obtained from the first round. The length of <code>gamma_bfi</code> equals the number of regression coefficients, including the intercept if <code>intercept=TRUE</code>, but excluding \(\zeta\), which represents the treatment effect, as well as the nuisance parameter \(\sigma\) in the <code>gaussian</code> family and any parameters of the baseline hazard (\(\boldsymbol{\omega}\)) for <code>survival</code>. This argument is used only when the argument <code>treatment</code> is not '<code>NULL</code>'. If <code>treatment</code> is not '<code>NULL</code>' but <code>gamma_bfi = NULL</code>, then the argument <code>RCT_propens</code> must not be '<code>NULL</code>', indicating an RCT study. See ‘Details’.</p></dd>


<dt id="arg-rct-propens">RCT_propens<a class="anchor" aria-label="anchor" href="#arg-rct-propens"></a></dt>
<dd><p>a vector specifying the propensity scores, which represent the probability of receiving the treatment given the covariates, which are known in the randomized studies (RCTs). For example, in a 1:1 randomized trial, the propensity scores are, by definition, equal to 1/2 (or 0.5), whereas in an unbalanced randomized trial, e.g., a 2:1 trial, the propensity scores are now 2/3 and 1/3 for the two arms, respectively. The length of <code>RCT_propens</code> equals to the number of individuals in the local center denoted as \(n_{\ell}\). This argument is used only when the study is a randomized control trial, i.e., the propensity scores are known for this local center. In this case, there is only ‘one’ round, and the argument <code>treatment</code> must not be '<code>NULL</code>', whereas <code>gamma_bfi = NULL</code>. Indeed, when 'treatment' is not '<code>NULL</code>', one of the arguments '<code>RCT_propens</code>' or '<code>gamma_bfi</code>' could be '<code>NULL</code>'. See ‘Details’.</p></dd>


<dt id="arg-initial">initial<a class="anchor" aria-label="anchor" href="#arg-initial"></a></dt>
<dd><p>a vector specifying initial values for the parameters to be optimized over. The length of <code>initial</code> is equal to the number of model parameters and thus, is equal to the number of rows or columns of <code>Lambda</code>. Since the <code>'L-BFGS-B'</code> method is used in the algorithm, these values should always be finite. Default is a vector of zeros, except for the <code>survival</code> family with the <code>poly</code> function, where it is a vector with the first \(p\) elements as zeros for coefficients (\(\boldsymbol{\beta}\)) and -0.5 for the remaining parameters (\(\boldsymbol{\omega}\)). For the <code>gaussian</code> family, the last element of the <code>initial</code> vector could also be considered negative, because the Gaussian prior was applied to \(log(\sigma^2)\).</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>a significance level used in the chi-squared distribution (with one degree of freedom and 1-\(\alpha\) representing the upper quantile) to conduct a likelihood ratio test for obtaining the order of the exponentiated polynomial baseline hazard function. It is only used when <code>family = "survival"</code> and <code>basehaz = "poly"</code>. Default is 0.1. See ‘Details’.</p></dd>


<dt id="arg-max-order">max_order<a class="anchor" aria-label="anchor" href="#arg-max-order"></a></dt>
<dd><p>an integer representing the maximum value of <code>q_l</code>, which is the order/degree minus 1 of the exponentiated polynomial baseline hazard function. This argument is only used when <code>family = "survival"</code> and <code>basehaz = "poly"</code>. Default is 2.</p></dd>


<dt id="arg-n-intervals">n_intervals<a class="anchor" aria-label="anchor" href="#arg-n-intervals"></a></dt>
<dd><p>an integer representing the number of intervals in the piecewise exponential baseline hazard function. This argument is only used when <code>family = "survival"</code> and <code>basehaz = "pwexp"</code>. Default is 4.</p></dd>


<dt id="arg-min-max-times">min_max_times<a class="anchor" aria-label="anchor" href="#arg-min-max-times"></a></dt>
<dd><p>a scalar representing the minimum of the maximum event times observed in the centers. The value of this argument should be defined by the central server (which has access to the maximum event times of all the centers) and is only used when <code>family = "survival"</code> and <code>basehaz = "pwexp"</code>.</p></dd>


<dt id="arg-center-zero-sample">center_zero_sample<a class="anchor" aria-label="anchor" href="#arg-center-zero-sample"></a></dt>
<dd><p>logical flag indicating whether the center has a categorical covariate with no observations/individuals in one of the categories. Default is <code>center_zero_sample = FALSE</code>.</p></dd>


<dt id="arg-zero-sample-cov">zero_sample_cov<a class="anchor" aria-label="anchor" href="#arg-zero-sample-cov"></a></dt>
<dd><p>either a character string or an integer representing the categorical covariate that has no samples/observations in one of its categories. This covariate should have at least two categories, one of which is the reference. It is used when <code>center_zero_sample = TRUE</code>.</p></dd>


<dt id="arg-refer-cat">refer_cat<a class="anchor" aria-label="anchor" href="#arg-refer-cat"></a></dt>
<dd><p>a character string representing the reference category. The category with no observations (the argument <code>zero_cat</code>) cannot be used as the reference in the argument <code>refer_cat</code>. It is used when <code>center_zero_sample = TRUE</code>.</p></dd>


<dt id="arg-zero-cat">zero_cat<a class="anchor" aria-label="anchor" href="#arg-zero-cat"></a></dt>
<dd><p>a character string representing the category with no samples/observations. It is used when <code>center_zero_sample = TRUE</code>.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>a list of control parameters. See ‘Details’.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<p><code>MAP.estimation</code> returns a list containing the following components:</p>
<dl><dt>theta_hat</dt>
<dd><p>the vector corresponding to the maximum a posteriori (MAP) estimates of the parameters. For the <code>gaussian</code> family, the last element of this vector is \(\sigma^2\);</p></dd>


<dt>A_hat</dt>
<dd><p>minus the curvature (or Hessian) matrix around the point <code>theta_hat</code>. The dimension of the matrix is the same as the argument <code>Lambda</code>;</p></dd>


<dt>sd</dt>
<dd><p>the vector of (posterior) standard deviation of the MAP estimates in <code>theta_hat</code>, that is <code>sqrt(diag(solve(A_hat)))</code>;</p></dd>


<dt>Lambda</dt>
<dd><p>the inverse variance-covariance matrix of the Gaussian distribution that is used as prior distribution for the parameters. It's exactly the same as the argument <code>Lambda</code>;</p></dd>


<dt>formula</dt>
<dd><p>the formula applied;</p></dd>


<dt>names</dt>
<dd><p>the names of the model parameters;</p></dd>


<dt>n</dt>
<dd><p>sample size, \(n_{\ell}\);</p></dd>


<dt>np</dt>
<dd><p>the number of coefficients;</p></dd>


<dt>q_l</dt>
<dd><p>the order/degree minus 1 of the exponentiated polynomial baseline hazard function determined for the current center by the likelihood ratio test. This output argument, <code>q_l</code>, is only shown when <code>family = "survival"</code> and <code>basehaz = "poly"</code>, and will be used in the function <code><a href="BFI.html">bfi()</a></code>;</p></dd>


<dt>theta_A_poly</dt>
<dd><p>an array where the first component is a matrix with columns representing the MAP estimates of the parameters for different <code>q_l</code>'s, i.e., <code>q_l</code>, <code>q_l</code>+1, ..., <code>max_order</code>. The other components are minus the curvature matrices for different <code>q_l</code>'s, i.e., <code>q_l</code>, <code>q_l</code>+1, ..., <code>max_order</code>. Therefore, the first non-NA curvature matrix is equal to the output argument <code>A_hat</code>. This output argument, <code>theta_A_poly</code>, is only shown if <code>family = "survival"</code> and <code>basehaz = "poly"</code>, and will be used in the function <code><a href="BFI.html">bfi()</a></code>;</p></dd>


<dt>lev_no_ref_zer</dt>
<dd><p>a vector containing the names of the levels of the categorical covariate that has no samples/observations in one of its categories. The name of the category with no samples and the name of the reference category are excluded from this vector. This argument is shown when <code>family = "survival"</code> and <code>basehaz = "poly"</code>, and will be used in the function <code><a href="BFI.html">bfi()</a></code>;</p></dd>


<dt>treatment</dt>
<dd><p>a character string representing the name or place of the binary covariate, respectively. If it is set to '<code>NULL</code>', the treatment effect will not be estimated;</p></dd>


<dt>refer_treat</dt>
<dd><p>the reference category of the treatment. It is shown when <code>treatment</code> is not '<code>NULL</code>', and can be used in the function <code><a href="BFI.html">bfi()</a></code>;</p></dd>


<dt>gamma_bfi</dt>
<dd><p>a vector specifying the BFI estimates of the coefficients received from the central server in the first round. If <code>treatment = NULL</code>, then <code>gamma_bfi</code> must also be '<code>NULL</code>';</p></dd>


<dt>RCT_propens</dt>
<dd><p>a vector specifying the propensity scores, which represent the probability of receiving the treatment given the covariates, which are known in the randomized studies (RCTs). If <code>treatment = NULL</code>, then <code>RCT_propens</code> must also be '<code>NULL</code>';</p></dd>


<dt>propensity</dt>
<dd><p>a vector specifying the propensity scores (the probability a patient gets the treatment given the characteristics measured at baseline) calculated by \(Pr(Z_\ell = 1 | X_\ell)\);</p></dd>


<dt>for_ATE</dt>
<dd><p>a vector used in the central server to calculate the average treatment effect (ATE). For <code>family</code> of <code>binomial</code> and <code>gaussian</code>, its elements are:</p><dl><dt>first</dt>
<dd><p>\(m_{\ell 1}\), the number of patients in the treatment group, where \(n_{\ell} = m_{\ell 1} + m_{\ell 2}\),</p></dd>


		<dt>second</dt>
<dd><p>\(m_{\ell 2}\), the number of patients in the reference group, where \(m_{\ell 2} = n_{\ell} - m_{\ell 1}\),</p></dd>


		<dt>third</dt>
<dd><p>\(\sum_{i=1}^{n_{\ell}} z_{\ell i} y_{\ell i}\),</p></dd>


		<dt>fourth</dt>
<dd><p>\(\sum_{i=1}^{n_{\ell}} (z_{\ell i} y_{\ell i})^{2} \),</p></dd>


		<dt>fifth</dt>
<dd><p>\(\sum_{i=1}^{n_{\ell}} z_{\ell i} / e_{\ell i}\),</p></dd>


		<dt>sixth</dt>
<dd><p>\(\sum_{i=1}^{n_{\ell}} z_{\ell i} y_{\ell i} /  e_{\ell i}\),</p></dd>


		<dt>seventh</dt>
<dd><p>\(\sum_{i=1}^{n_{\ell}} (1 - z_{\ell i}) / (1 - e_{\ell i})\),</p></dd>


		<dt>eighth</dt>
<dd><p>\(\sum_{i=1}^{n_{\ell}} (1 - z_{\ell i}) y_{\ell i} / (1 - e_{\ell i})\),</p></dd>


		<dt>ninth</dt>
<dd><p>\(\sum_{i=1}^{n_{\ell}} (1 - z_{\ell i}) y_{\ell i}\),</p></dd>

	
</dl><p>but in <code>survival</code>, its elements are:</p><dl><dt>first</dt>
<dd><p>\(\hat \zeta_\ell\), the weighted MAP estimates of the treatment effect \( \zeta_\ell\) in center \(\ell\),</p></dd>

		<dt>second</dt>
<dd><p>\(\hat{\bold{A}}_\ell\), minus the curvature (1\(\times\)1)-dimensional matrix estimates (variance) around \( \zeta_\ell\) in center \(\ell\),</p></dd>

		<dt>third</dt>
<dd><p>standard deviation of \( \zeta_\ell\) in center \(\ell\), i.e., , <code>sqrt(solve(for_ATE[2]))</code></p></dd>

		<dt>fourth</dt>
<dd><p>an integer value used to encode the warnings and the errors related to the algorithm used to maximaze the weighted partial log likelihood;</p></dd>

		
</dl></dd>


<dt>zero_sample_cov</dt>
<dd><p>the categorical covariate that has no samples/observations in one of its categories. It is shown when <code>center_zero_sample = TRUE</code>, and can be used in the function <code><a href="BFI.html">bfi()</a></code>;</p></dd>


<dt>refer_cat</dt>
<dd><p>the reference category. It is shown when <code>center_zero_sample = TRUE</code>, and can be used in the function <code><a href="BFI.html">bfi()</a></code>;</p></dd>


<dt>zero_cat</dt>
<dd><p>the category with no samples/observations. It is shown when <code>center_zero_sample = TRUE</code>, and can be used in the function <code><a href="BFI.html">bfi()</a></code>;</p></dd>


<dt>value</dt>
<dd><p>the value of minus the log-likelihood posterior density evaluated at <code>theta_hat</code>;</p></dd>


<dt>family</dt>
<dd><p>the <code>family</code> used;</p></dd>


<dt>basehaz</dt>
<dd><p>the baseline hazard function used;</p></dd>


<dt>intercept</dt>
<dd><p>logical flag used to fit an intercept if <code>TRUE</code>, or set to zero if <code>FALSE</code>;</p></dd>


<dt>convergence</dt>
<dd><p>an integer value used to encode the warnings and the errors related to the algorithm used to fit the model. The values returned are:</p><dl><dt>0</dt>
<dd><p>algorithm has converged,</p></dd>


		<dt>1</dt>
<dd><p>maximum number of iterations ('<code>maxit</code>') has been reached,</p></dd>


		<dt>2</dt>
<dd><p>Warning from the 'L-BFGS-B' method. See the message after this value;</p></dd>

	
</dl></dd>


<dt>control</dt>
<dd><p>the list of control parameters used to compute the MAP estimates.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>MAP.estimation</code> function finds the Maximum A Posteriori (MAP) estimates of the model parameters by maximizing the log-posterior density with respect to the parameters, i.e., the estimates equal the values for which the log-posterior density is maximal (the posterior mode).
In other words, <code>MAP.estimation()</code> optimizes the log-posterior density with respect to the parameter vector to obtain its MAP estimates.
In addition to the model parameters (i.e., coefficients (\(\boldsymbol{\beta}\)) and variance error (\(\sigma^2_e\)) for <code>gaussian</code> or the parameters of the baseline hazard (\(\boldsymbol{\omega}\)) for <code>survival</code>), the curvature matrix (Hessian of the log-posterior) is estimated around the mode.</p>
<p>The <code>MAP.estimation</code> function returns an object of class `<code>bfi</code>`. Therefore, <code><a href="summary.bfi.html">summary()</a></code> can be used for the object returned by <code>MAP.estimation()</code>.</p>
<p>For the case where <code>family = "survival"</code> and <code>basehaz = "poly"</code>, we assume that in all centers the \(q_\ell\)'s are equal.
However, the order of the estimated polynomials may vary across the centers so that each center can have different number of parameters, say \(q_\ell\)+1.
<!-- %Thus, in each location, the vector parameter is a (\eqn{ p+q_\ell} +1)-dimensional vector \eqn{\boldsymbol{\theta}_\ell^\top=(\boldsymbol{\beta}^\top, \boldsymbol{\omega}_\ell^\top)=(\beta_1, \ldots,\beta_p, \omega_{0}, \omega_{1}, \ldots, \omega_{q_\ell})}. -->
After obtaining the estimates within the local centers (by using <code>MAP.estimation()</code>) and having all estimates in the central server, we choose the order of the polynomial approximation for the combined data to be the maximum of the orders of the local polynomial functions, i.e., \(\max \{q_1, \ldots, q_L \}\), to approximate the global baseline hazard (exponentiated polynomial) function more accurately. This is because the higher-order polynomial approximation can capture more complex features and details in the combined data. Using the higher-order approximation ensures that we account for the higher-order moments and features present in the data while maintaining accuracy.
As a result, all potential cases are stored in the <code>theta_A_poly</code> argument to be used in <code><a href="BFI.html">bfi()</a></code> by the central server.
For further information on the <code>survival</code> family, refer to the 'References' section.</p>
<p>The three arguments <code>treatment</code>, <code>gamma_bfi</code>, and <code>RCT_propens</code> are related to the estimation of the treatment effect.
For observational and non-randomized studies, the treatment effect is estimated in two rounds; In the first round, \(\hat{\boldsymbol{\beta}}_{\ell}\) (or \(\hat{\boldsymbol{\gamma}}_{\ell}\)) are estimated locally and in the central server \(\hat{\boldsymbol{\beta}}_{BFI}\) (or \(\hat{\boldsymbol{\gamma}}_{BFI}\)) is estimated and then is sent to all centers for the second round. In the first round, the argument <code>treatment</code> should not be '<code>NULL</code>', while <code>gamma_bfi = NULL</code> and <code>RCT_propens = NULL</code>. Moreover, in the first round, the family must be set to <code>binomial</code>, but this is handled automatically. In the second round, propensity scores are estimated, and some summary statistics are sent to the central server to estimate the average treatment estimate, ATE (in this case <code>treatment</code> and <code>gamma_bfi</code> should not be '<code>NULL</code>', but <code>RCT_propens = NULL</code>).
In contrast, for the randomized control trial (RCT), the treatment effect can be estimated by only one round as the propensity scores are known (in this case <code>treatment</code> and <code>RCT_propens</code> should not be '<code>NULL</code>', but <code>gamma_bfi = NULL</code>).
NOTE: the argument <code>gamma_bfi</code> should not include estimates of the nuisance parameter \(\sigma\) in the <code>gaussian</code> family or any parameters of the baseline hazard (\(\boldsymbol{\omega}\)) for <code>survival</code>. Check this: <code>identical(names(gamma_bfi), X[, -which(colnames(X) == treatment)])</code> should be <code>TRUE</code>.
For more examples on treatment effect estimation, see the ‘Examples’ section of <code><a href="BFI.html">bfi</a></code>.</p>
<p>To solve unconstrained and bound-constrained optimization problems, the <code>MAP.estimation</code> function utilizes an optimization algorithm called Limited-memory Broyden-Fletcher-Goldfarb-Shanno with Bound Constraints (L-BFGS-B), Byrd et. al. (1995).
The L-BFGS-B algorithm is a limited-memory “quasi-Newton” method that iteratively updates the parameter estimates by approximating the inverse Hessian matrix using gradient information from the history of previous iterations. This approach allows the algorithm to approximate the curvature of the posterior distribution and efficiently search for the optimal solution, which makes it computationally efficient for problems with a large number of variables.</p>
<p>By default, the algorithm uses a relative change in the objective function as the convergence criterion. When the change in the objective function between iterations falls below a certain threshold (`<code>factr</code>`) the algorithm is considered to have converged.
The convergence can be checked with the argument <code>convergence</code> in the output. See ‘Value’.</p>
<p>In case of convergence issue, it may be necessary to investigate and adjust optimization parameters to facilitate convergence. It can be done using the <code>initial</code> and <code>control</code> arguments. By the argument <code>initial</code> the initial points of the interative optimization algorithm can be changed, and the argument <code>control</code> is a list that can supply any of the following components:</p>
<dl><dt><code>maxit</code>:</dt>
<dd><p>is the maximum number of iterations. Default is 150;</p></dd>


<dt><code>factr</code>:</dt>
<dd><p>controls the convergence of the <code>'L-BFGS-B'</code> method. Convergence occurs when the reduction in the objective is within this factor of the machine tolerance. Default for <code>factr</code> is 1e7, which gives a tolerance of about 1e-9. The exact tolerance can be checked by multiplying this value by <code>.Machine$double.eps</code>;</p></dd>


<dt><code>pgtol</code>:</dt>
<dd><p>helps to control the convergence of the <code>'L-BFGS-B'</code> method. It is a tolerance on the projected gradient in the current search direction, i.e., the iteration will stop when the maximum component of the projected gradient is less than or equal to <code>pgtol</code>, where <code>pgtol</code>\(\geq 0\). Default is zero, when the check is suppressed;</p></dd>


<dt><code>trace</code>:</dt>
<dd><p>is a non-negative integer. If positive, tracing information on the progress of the optimization is produced. Higher values may produce more tracing information: for the method <code>'L-BFGS-B'</code> there are six levels of tracing. To understand exactly what these do see the source code of <code>optim</code> function in the <span class="pkg"><a href="https://rdrr.io/r/stats/stats-package.html" class="external-link">stats</a></span> package;</p></dd>


<dt><code>REPORT</code>:</dt>
<dd><p>is the frequency of reports for the <code>'L-BFGS-B'</code> method if <code>'control$trace'</code> is positive. Default is every 10 iterations;</p></dd>


<dt><code>lmm</code>:</dt>
<dd><p>is an integer giving the number of <code>BFGS</code> updates retained in the <code>'L-BFGS-B'</code> method. Default is 5.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jonker M.A., Pazira H. and Coolen A.C.C. (2024). <em>Bayesian federated inference for estimating statistical models based on non-shared multicenter data sets</em>, <em>Statistics in Medicine</em>, 43(12): 2421-2438. &lt;https://doi.org/10.1002/sim.10072&gt;</p>
<p>Pazira H., Massa E., Weijers J.A.M., Coolen A.C.C. and Jonker M.A. (2025b). <em>Bayesian Federated Inference for Survival Models</em>, <em>Journal of Applied Statistics (Accepted)</em>. &lt;https://arxiv.org/abs/2404.17464&gt;</p>
<p>Jonker M.A., Pazira H. and Coolen A.C.C. (2025a). <em>Bayesian Federated Inference for regression models based on non-shared medical center data</em>, <em>Research Synthesis Methods</em>, 1-41. &lt;https://doi.org/10.1017/rsm.2025.6&gt;</p>
<p>van den Heuvel Z.D., Pazira H. and Jonker M.A. (2025c). <em>Bayesian Federated Causal Inference from observational data</em>, <em>arXiv</em>. &lt;https://arxiv.org/abs/???&gt;</p>
<p>Byrd R.H., Lu P., Nocedal J. and Zhu C. (1995). <em>A limited memory algorithm for bound constrained optimization</em>. SIAM Journal on Scientific Computing, 16, 1190-1208. &lt;https://doi.org/10.1137/0916069&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Hassan Pazira and Marianne Jonker <br>
Maintainer: Hassan Pazira <a href="mailto:hassan.pazira@radboudumc.nl">hassan.pazira@radboudumc.nl</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="BFI.html">bfi</a></code>, <code><a href="inv.prior.cov.html">inv.prior.cov</a></code> and <code><a href="summary.bfi.html">summary.bfi</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###--------------###</span></span></span>
<span class="r-in"><span><span class="co">### y ~ Gaussian ###</span></span></span>
<span class="r-in"><span><span class="co">###--------------###</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setting a seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11235</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model parameters: coefficients and sigma2 = 1.5</span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------</span></span></span>
<span class="r-in"><span><span class="co"># Data Simulation</span></span></span>
<span class="r-in"><span><span class="co">#----------------</span></span></span>
<span class="r-in"><span><span class="va">n</span>   <span class="op">&lt;-</span> <span class="fl">30</span>   <span class="co"># sample size</span></span></span>
<span class="r-in"><span><span class="va">p</span>   <span class="op">&lt;-</span> <span class="fl">3</span>    <span class="co"># number of coefficients without intercept</span></span></span>
<span class="r-in"><span><span class="va">X</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="co"># continuous variables</span></span></span>
<span class="r-in"><span><span class="co"># linear predictor:</span></span></span>
<span class="r-in"><span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">$</span><span class="va">X1</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">$</span><span class="va">X2</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">$</span><span class="va">X3</span></span></span>
<span class="r-in"><span><span class="co"># inverse of the link function ( g^{-1}(\eta) = \mu ):</span></span></span>
<span class="r-in"><span><span class="va">mu</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">linkinv</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load the BFI package</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hassanpazira.github.io/BFI/">BFI</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># MAP estimations for theta and curvature matrix</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># MAP estimates with 'intercept'</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, <span class="va">Lambda</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $theta_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          X1          X2          X3      sigma2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1.341258    2.236391    2.071001    2.164002    1.054571 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $A_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)         X1         X2         X3     sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  28.5475747  1.9315730 -7.7385763  6.2804549 -0.2682462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1            1.9315730 20.4369223 -2.2127254  4.5673270 -0.4472059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2           -7.7385763 -2.2127254 49.3206700  3.1359341 -0.4141474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3            6.2804549  4.5673270  3.1359341 24.3657850 -0.4327445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2       -0.2682462 -0.4472059 -0.4141474 -0.4327445 64.2183745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          X1          X2          X3      sigma2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.1982976   0.2269483   0.1476575   0.2153269   0.1248065 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)  X1  X2  X3 sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)         0.1 0.0 0.0 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1                  0.0 0.1 0.0 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2                  0.0 0.0 0.1 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3                  0.0 0.0 0.0 0.1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2              0.0 0.0 0.0 0.0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] y ~ X1 + X2 + X3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "(Intercept)" "X1"          "X2"          "X3"          "sigma2"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $np</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $treatment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $zero_sample_cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $refer_cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $zero_cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 35.28046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gaussian"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $basehaz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "weibul"      "exp"         "gomp"        "poly"        "pwexp"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "unspecified"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $intercept</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $control$maxit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bfi"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bfi"</span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the local model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: y ~ X1 + X2 + X3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘gaussian’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Link: ‘identity’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)   1.3413  0.1983  0.9526   1.7299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1            2.2364  0.2269  1.7916   2.6812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2            2.0710  0.1477  1.7816   2.3604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3            2.1640  0.2153  1.7420   2.5860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion parameter (sigma2):  1.055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             log Lik Posterior:  -35.28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)      X1      X2      X3  sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     28.5476  1.9316 -7.7386  6.2805 -0.2682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1               1.9316 20.4369 -2.2127  4.5673 -0.4472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2              -7.7386 -2.2127 49.3207  3.1359 -0.4141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3               6.2805  4.5673  3.1359 24.3658 -0.4327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2          -0.2682 -0.4472 -0.4141 -0.4327 64.2184</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># MAP estimates without 'intercept'</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">'gaussian'</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">'gaussian'</span>, <span class="va">Lambda</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $theta_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       X1       X2       X3   sigma2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.241637 1.832740 2.525235 2.496099 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $A_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                X1         X2         X3     sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      8.6921038 -0.9348497  1.9296405 -0.4483243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     -0.9348497 20.8951379  1.3248942 -0.3665339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      1.9296405  1.3248942 10.3520007 -0.5050368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2 -0.4483243 -0.3665339 -0.5050368 69.9843284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        X1        X2        X3    sigma2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3478802 0.2205610 0.3192969 0.1195753 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         X1  X2  X3 sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1     0.1 0.0 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     0.0 0.1 0.0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3     0.0 0.0 0.1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2 0.0 0.0 0.0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] y ~ X1 + X2 + X3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "X1"     "X2"     "X3"     "sigma2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $np</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $treatment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $zero_sample_cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $refer_cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $zero_cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 63.9101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "gaussian"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $basehaz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "weibul"      "exp"         "gomp"        "poly"        "pwexp"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "unspecified"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $intercept</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $control$maxit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bfi"</span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit1</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the local model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: y ~ X1 + X2 + X3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘gaussian’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Link: ‘identity’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1   2.2416  0.3479  1.5598   2.9235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2   1.8327  0.2206  1.4004   2.2650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3   2.5252  0.3193  1.8994   3.1510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dispersion parameter (sigma2):  2.496 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             log Lik Posterior:  -63.91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             X1      X2      X3  sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      8.6921 -0.9348  1.9296 -0.4483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2     -0.9348 20.8951  1.3249 -0.3665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      1.9296  1.3249 10.3520 -0.5050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2 -0.4483 -0.3665 -0.5050 69.9843</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###-----------------###</span></span></span>
<span class="r-in"><span><span class="co">### Survival family ###</span></span></span>
<span class="r-in"><span><span class="co">###-----------------###</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setting a seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">112358</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Simulating Survival data</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------</span></span></span>
<span class="r-in"><span><span class="va">n</span>    <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span></span>
<span class="r-in"><span><span class="va">p</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">p</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="co"># continuous (normal) variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Simulating survival data from Weibull with a predefined censoring rate of 0.3</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="surv.simulate.html">surv.simulate</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, beta <span class="op">=</span> <span class="va">beta</span>, a <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1.8</span><span class="op">)</span>, u1 <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                   cen_rate <span class="op">=</span> <span class="fl">0.3</span>, gen_data_from <span class="op">=</span> <span class="st">"weibul"</span><span class="op">)</span><span class="op">$</span><span class="va">D</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># MAP estimations with "weibul" function</span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">'survival'</span>, basehaz <span class="op">=</span> <span class="st">"weibul"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">'survival'</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>, basehaz <span class="op">=</span> <span class="st">"weibul"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $theta_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       X1       X2       X3       X4  omega_1  omega_2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.216502 2.433061 3.305429 4.895585 1.411903 1.905060 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $A_hat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 X1          X2          X3          X4     omega_1   omega_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1       54.813643    8.232601   -3.813501   -5.643886    7.220449  -49.8473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        8.232601   85.409611   -5.039660  -16.200600   15.679748 -130.8181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3       -3.813501   -5.039660   57.371520    4.560337   -2.868448 -186.1929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4       -5.643886  -16.200600    4.560337   56.028421   23.120562 -262.4108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1   7.220449   15.679748   -2.868448   23.120562   77.588076 -229.2848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2 -49.847299 -130.818053 -186.192918 -262.410849 -229.284799 2656.6802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         X1         X2         X3         X4    omega_1    omega_2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.15896950 0.19980633 0.26038338 0.36632933 0.14912596 0.06994841 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          X1  X2  X3  X4 omega_1 omega_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      0.1 0.0 0.0 0.0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2      0.0 0.1 0.0 0.0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      0.0 0.0 0.1 0.0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4      0.0 0.0 0.0 0.1       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1 0.0 0.0 0.0 0.0       1       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2 0.0 0.0 0.0 0.0       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Survival(time, status) ~ X1 + X2 + X3 + X4"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "X1"      "X2"      "X3"      "X4"      "omega_1" "omega_2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $np</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $treatment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $zero_sample_cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $refer_cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $zero_cat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -61.88167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "survival"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $basehaz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "weibul"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $intercept</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $control$maxit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bfi"</span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit2</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the local model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: Survival(time, status) ~ X1 + X2 + X3 + X4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘survival’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Baseline: ‘weibul’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1        1.2165  0.1590  0.9049   1.5281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        2.4331  0.1998  2.0414   2.8247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3        3.3054  0.2604  2.7951   3.8158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4        4.8956  0.3663  4.1776   5.6136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1   1.4119  0.1491  1.1196   1.7042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2   1.9051  0.0699  1.7680   2.0422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log Lik Posterior:  61.88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               X1        X2        X3        X4   omega_1   omega_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1       54.8136    8.2326   -3.8135   -5.6439    7.2204  -49.8473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        8.2326   85.4096   -5.0397  -16.2006   15.6797 -130.8181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3       -3.8135   -5.0397   57.3715    4.5603   -2.8684 -186.1929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4       -5.6439  -16.2006    4.5603   56.0284   23.1206 -262.4108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1   7.2204   15.6797   -2.8684   23.1206   77.5881 -229.2848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2 -49.8473 -130.8181 -186.1929 -262.4108 -229.2848 2656.6802</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># MAP estimations with "poly" function</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">'survival'</span>, basehaz <span class="op">=</span> <span class="st">'poly'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">"survival"</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>, basehaz <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Degree of the exponentiated polynomial baseline hazard</span></span></span>
<span class="r-in"><span><span class="va">fit3</span><span class="op">$</span><span class="va">q_l</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="co"># theta_hat for (beta_1, ..., beta_p, omega_0, ..., omega_{q_l})</span></span></span>
<span class="r-in"><span><span class="va">fit3</span><span class="op">$</span><span class="va">theta_A_poly</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span><span class="op">[</span>,<span class="va">fit3</span><span class="op">$</span><span class="va">q_l</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="co"># equal to fit3$theta_hat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         X1         X2         X3         X4    omega_0    omega_1    omega_2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.4587444  0.9065738  1.2387261  1.8013492 -2.0743547  4.7662933 -1.0941826 </span>
<span class="r-in"><span><span class="co"># A_hat</span></span></span>
<span class="r-in"><span><span class="va">fit3</span><span class="op">$</span><span class="va">theta_A_poly</span><span class="op">[</span>,,<span class="va">fit3</span><span class="op">$</span><span class="va">q_l</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span> <span class="co"># equal to fit3$A_hat</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]      [,2]       [,3]       [,4]      [,5]       [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      67.2578299  3.698096  -6.328249  -0.830014  7.296302   1.005843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2       3.6980959 85.034720   3.130474  -6.311998 15.832762  -1.055534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      -6.3282486  3.130474  73.449859  11.351621 -2.661869 -25.299425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4      -0.8300140 -6.311998  11.351621  68.043358 23.430052  -8.113705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_0  7.2963020 15.832762  -2.661869  23.430052 90.074528  43.191997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1  1.0058432 -1.055534 -25.299425  -8.113705 43.191997  57.713003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2 -0.7626327 -7.194974 -42.325003 -19.174732 48.713003  71.822389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1       -0.7626327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2       -7.1949742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      -42.3250033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4      -19.1747319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_0  48.7130029</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1  71.8223891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2 122.9402820</span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit3</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the local model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: Survival(time, status) ~ X1 + X2 + X3 + X4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘survival’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Baseline: ‘poly’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1        0.4587  0.1242  0.2153   0.7022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        0.9066  0.1159  0.6793   1.1338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3        1.2387  0.1364  0.9713   1.5061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4        1.8013  0.1460  1.5153   2.0874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_0  -2.0744  0.1647 -2.3971  -1.7516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1   4.7663  0.2867  4.2044   5.3282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2  -1.0942  0.1826 -1.4520  -0.7364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log Lik Posterior:  -1.084 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              X1      X2       X3       X4 omega_0  omega_1  omega_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      67.2578  3.6981  -6.3282  -0.8300  7.2963   1.0058  -0.7626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2       3.6981 85.0347   3.1305  -6.3120 15.8328  -1.0555  -7.1950</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      -6.3282  3.1305  73.4499  11.3516 -2.6619 -25.2994 -42.3250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4      -0.8300 -6.3120  11.3516  68.0434 23.4301  -8.1137 -19.1747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_0  7.2963 15.8328  -2.6619  23.4301 90.0745  43.1920  48.7130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1  1.0058 -1.0555 -25.2994  -8.1137 43.1920  57.7130  71.8224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2 -0.7626 -7.1950 -42.3250 -19.1747 48.7130  71.8224 122.9403</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># MAP estimations with "pwexp" function with 3 intervals</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Assume we have 4 centers</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">'survival'</span>,</span></span>
<span class="r-in"><span>                        basehaz <span class="op">=</span> <span class="st">'pwexp'</span>, n_intervals <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># For this baseline hazard ("pwexp"), we need to know</span></span></span>
<span class="r-in"><span><span class="co"># maximum survival times of the 3 other centers:</span></span></span>
<span class="r-in"><span><span class="va">max_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Minimum of the maximum values of the survival times of all 4 centers is:</span></span></span>
<span class="r-in"><span><span class="va">min_max_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>, <span class="va">max_times</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">"survival"</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>, basehaz <span class="op">=</span> <span class="st">"pwexp"</span>,</span></span>
<span class="r-in"><span>                       n_intervals <span class="op">=</span> <span class="fl">3</span>, min_max_times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  No. observations in the intervals :  73 18 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit4</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the local model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: Survival(time, status) ~ X1 + X2 + X3 + X4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘survival’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Baseline: ‘pwexp’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1        0.3310  0.1353  0.0658   0.5961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2        0.6246  0.1242  0.3812   0.8680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3        0.7795  0.1377  0.5097   1.0493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4        1.1811  0.1588  0.8699   1.4924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1  -0.3968  0.1787 -0.7471  -0.0465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2   1.4806  0.2910  0.9104   2.0509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_3   1.4282  0.6395  0.1747   2.6817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log Lik Posterior:  -27.06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              X1      X2       X3      X4 omega_1  omega_2 omega_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1      58.2386  2.0588  -8.1905 -0.7741  7.5573  -0.4890  0.2409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2       2.0588 74.7939   1.2829 -3.3496 16.9213  -0.5449 -0.5155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3      -8.1905  1.2829  65.1478  9.3205  9.5898 -10.3783 -1.8274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4      -0.7741 -3.3496   9.3205 64.3901 31.2096  -6.2708 -1.4469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_1  7.5573 16.9213   9.5898 31.2096 54.3965   0.0000  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_2 -0.4890 -0.5449 -10.3783 -6.2708  0.0000  14.5194  0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> omega_3  0.2409 -0.5155  -1.8274 -1.4469  0.0000   0.0000  2.5716</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Semi-parametric Cox model</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">'survival'</span>, basehaz <span class="op">=</span> <span class="st">"unspecified"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu">MAP.estimation</span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">'survival'</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>, basehaz <span class="op">=</span> <span class="st">"unspecified"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="summary.bfi.html">summary</a></span><span class="op">(</span><span class="va">fit5</span>, cur_mat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of the local model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Formula: Survival(time, status) ~ X1 + X2 + X3 + X4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Family: ‘survival’ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Baseline: ‘unspecified’</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std.Dev CI 2.5% CI 97.5%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1   1.2473  0.1869  0.8811   1.6136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2   2.3849  0.2668  1.8620   2.9077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3   3.0800  0.3251  2.4428   3.7172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4   4.8160  0.4949  3.8460   5.7860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log Lik Posterior:  -145.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Convergence:  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minus the Curvature Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          X1       X2       X3       X4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X1  52.6669   2.9390  -6.7156 -10.8854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X2   2.9390  58.7634 -11.4832 -21.7196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X3  -6.7156 -11.4832  35.4618 -12.5839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X4 -10.8854 -21.7196 -12.5839  23.8793</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hassan Pazira, Emanuele Massa, Marianne A. Jonker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

