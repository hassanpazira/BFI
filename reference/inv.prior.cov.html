<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="inv.prior.cov builds a diagonal inverse covariance matrix for the Gaussian prior distribution based on the design matrix of covariates, that takes into account the number of regression parameters in case of categorical covariates.  In case of a linear model, it also includes the variance of the measurement errors."><title>Creates an inverse covariance matrix for a Gaussian prior — inv.prior.cov • BFI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creates an inverse covariance matrix for a Gaussian prior — inv.prior.cov"><meta property="og:description" content="inv.prior.cov builds a diagonal inverse covariance matrix for the Gaussian prior distribution based on the design matrix of covariates, that takes into account the number of regression parameters in case of categorical covariates.  In case of a linear model, it also includes the variance of the measurement errors."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BFI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/BFI.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Creates an inverse covariance matrix for a Gaussian prior</h1>
      
      <div class="d-none name"><code>inv.prior.cov.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>inv.prior.cov</code> builds a diagonal inverse covariance matrix for the Gaussian prior distribution based on the design matrix of covariates, that takes into account the number of regression parameters in case of categorical covariates.  In case of a linear model, it also includes the variance of the measurement errors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">inv.prior.cov</span><span class="op">(</span><span class="va">X</span>, lambda <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">gaussian</span>, stratified <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              strat_par <span class="op">=</span> <span class="cn">NULL</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>design matrix of dimension \(n \times p\), where \(n\) is the number of samples observed, and \(p\) is the number of predictors/variables.</p></dd>


<dt>lambda</dt>
<dd><p>the vector used as the diagonal of the (inverse covariance) matrix created by <code>inv.prior.cov()</code>. The length of the vector depends on the number of columns of <code>X</code>, type of the covariates (continuous/dichotomous or categorical), <code>family</code>, whether an <code>intercept</code> is included in the model, and whether <code>stratified</code> analysis is desired. When <code>stratified = FALSE</code>, <code>lambda</code> could be a single positive number (if all values in the vector are equal), a vector of two elements (the first is used for regression parameters including ``intercept'' and the second for the ``sigma2''), or a vector of length equal to the number of model parameters. However, the length of <code>lambda</code> is different when <code>stratified = TRUE</code>, see ‘Details’ for more information. Default is <code>lambda = 1</code>.</p></dd>



<dt>family</dt>
<dd><p>a description of the error distribution and link function used to specify the model. This can be a character string naming a family function or the result of a call to a family function (see <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></code> for details). In the current version, the family of model can be <code>gaussian</code> (with <code>identity</code> link function) and <code>binomial</code> (with <code>logit</code> link function). By default the <code>gaussian</code> family is used. In case of a linear regression model, <code>family = gaussian</code>, there is an extra model parameter for the variance of measurement error.</p></dd>


<dt>intercept</dt>
<dd><p>logical flag for having an intercept. By changing the <code>intercept</code> the dimension of the inverse covariance matrix changes. If <code>intercept = TRUE</code> (the default), the output matrix created by <code>inv.prior.cov()</code> has one row and one column related to <code>intercept</code>, while if <code>intercept = FALSE</code>, the resulting matrix does not have the row and column called <code>intercept</code>.</p></dd>


<dt>stratified</dt>
<dd><p>logical flag for performing the stratified analysis. If <code>stratified = TRUE</code>, the parameter(s) selected in the <code>strat_par</code> argument are allowed to be different across centers. Default is <code>stratified = FALSE</code>. See ‘Details’ and ‘Examples’.</p></dd>


<dt>strat_par</dt>
<dd><p>a one- or two-element integer vector for indicating the stratification parameter(s). The values \(1\) and/or \(2\) are/is used to indicate that the ``intercept'' and/or ``sigma2'' are allowed to vary, respectively. This argument is used only when <code>stratified = TRUE</code>. Default is <code>strat_par = NULL</code>, but if <code>stratified = TRUE</code>, <code>strat_par</code> can not be <code>NULL</code>. For the <code>binomial</code> family the length of the vector should be one which refers to ``intercept'', and the value of this element should be \(1\). For <code>gaussian</code> this vector can be \(1\) for indicating the ``intercept'' only, \(2\) for indicating the ``sigma2'' only, and c(\(1\), \(2\)) for both ``intercept'' and ``sigma2''. See ‘Examples’.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>inv.prior.cov</code> creates a diagonal matrix with the vector <code>lambda</code> as its diagonal.</p>
<p>When <code>stratified = TRUE</code>, the length of the vector <code>lambda</code> depends on the covariate matrix <code>X</code>, <code>family</code>, and whether an ``intercept'' is included in the model. For example, if the design matrix <code>X</code> has <code>p</code> columns with continuous or dichotomous covariates, <code>family = gaussian</code>, and <code>intercept = TRUE</code>, then <code>lambda</code> should have \(p+2\) elements. In this case, if in <code>X</code> there is any categorical covariates with \(q&gt;2\) categories, then the length of <code>lambda</code> increases \(q-2\) unit for each categorical covariate. All values should be non-negative as they represent the variance of the Gaussian prior.
Note that, if all values in the vector <code>lambda</code> equal, one value is enough to be given as entry.
If <code>lambda</code> is a scalar, the function <code>inv.prior.cov</code> sets each value at the diagonal equal to <code>lambda</code>. In the linear regression model the last parameter is assumed to be the variance of measurement error. If <code>lambda</code> is two dimensional, the first value is used for the prior of the regression parameters and the second for the variance of the measurement error.</p>
<p>If <code>stratified = TRUE</code> and <code>strat_par = </code>\(1\), <code>lambda</code> could be a vector of \(L+p+1\) elements where \(\) is the number of regression parameters except the intercept (the first \(L\) elements are used for the \(L\) different ``intercept''s for the locatoins, while the \((L+1)^{\th}\) to \((L+p)^{\th}\) elements are used for regression parameters excluding intercept and the last value is used for ``sigma2''). If <code>stratified = TRUE</code> and <code>strat_par = </code>\(2\), <code>lambda</code> could be a vector of \(1+p+L\) elements where the first element is used for the ``intercept''s of the locatoins, while the \((L+1)^{\th}\) and \((L+2)^{\th}\) elements are used for regression parameters (excluding intercept) and ``sigma2'', respectively). But if <code>stratified = TRUE</code> and <code>strat_par = </code>c(\(1\), \(2\)), <code>lambda</code> could be a vector of \(2L+1\) elements.</p>
<p>If <code>intercept = FALSE</code>, for the <code>binomial</code> family the stratified analysis is not possible therefore <code>stratified</code> can not be <code>TRUE</code>.</p>
<p>The output of <code>inv.prior.cov()</code> is used in the main functions <code><a href="MAP.estimation.html">MAP.estimation()</a></code> and <code><a href="BFI.html">bfi()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>inv.prior.cov</code> returns a diagonal matrix. The dimension of the matrix depends on the number of columns of <code>X</code>, type of the covariates (continuous/dichotomous or categorical), <code>family</code>, and <code>intercept</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jonker M.A., Pazira H. and Coolen A.C.C. (2023). <em>Bayesian Federated Inference for Statistical Models</em>,
Statistics in Medicine, Vol. 0(0), 0-0. &lt;https://doi.org/10.48550/arXiv.2302.07677&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Hassan Pazira<br>
Maintainer: Hassan Pazira <a href="mailto:hassan.pazira@radboudumc.nl">hassan.pazira@radboudumc.nl</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MAP.estimation.html">MAP.estimation</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#----------------</span></span></span>
<span class="r-in"><span><span class="co"># Data Simulation</span></span></span>
<span class="r-in"><span><span class="co">#----------------</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>,                     <span class="co"># standard normal variable</span></span></span>
<span class="r-in"><span>                x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">50</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># categorical variable</span></span></span>
<span class="r-in"><span>                x3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">50</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># dichotomous variable</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">$</span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">$</span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">x3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The (inverse) variance value (lambda=0.05) is assumed to be</span></span></span>
<span class="r-in"><span><span class="co"># the same for Gaussian prior of all parameters</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># y ~ Binomial with intercept</span></span></span>
<span class="r-in"><span><span class="fu">inv.prior.cov</span><span class="op">(</span><span class="va">X</span>, lambda<span class="op">=</span><span class="fl">0.05</span>, family<span class="op">=</span><span class="va">binomial</span><span class="op">)</span> <span class="co"># returns a 5-by-5 matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)   x1  x21  x22  x31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        0.05 0.00 0.00 0.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1                 0.00 0.05 0.00 0.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x21                0.00 0.00 0.05 0.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x22                0.00 0.00 0.00 0.05 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x31                0.00 0.00 0.00 0.00 0.05</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># y ~ Binomial without intercept</span></span></span>
<span class="r-in"><span><span class="fu">inv.prior.cov</span><span class="op">(</span><span class="va">X</span>, lambda<span class="op">=</span><span class="fl">0.05</span>, family<span class="op">=</span><span class="st">"binomial"</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># a 4-by-4 matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1  x21  x22  x31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1  0.05 0.00 0.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x21 0.00 0.05 0.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x22 0.00 0.00 0.05 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x31 0.00 0.00 0.00 0.05</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># y ~ Gaussian with intercept</span></span></span>
<span class="r-in"><span><span class="fu">inv.prior.cov</span><span class="op">(</span><span class="va">X</span>, lambda<span class="op">=</span><span class="fl">0.05</span>, family<span class="op">=</span><span class="va">gaussian</span><span class="op">)</span> <span class="co"># a 6-by-6 matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)   x1  x21  x22  x31 sigma2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        0.05 0.00 0.00 0.00 0.00   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1                 0.00 0.05 0.00 0.00 0.00   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x21                0.00 0.00 0.05 0.00 0.00   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x22                0.00 0.00 0.00 0.05 0.00   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x31                0.00 0.00 0.00 0.00 0.05   0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma2             0.00 0.00 0.00 0.00 0.00   0.05</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Hassan Pazira, Marianne A. Jonker, Anthony C.C. Coolen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

