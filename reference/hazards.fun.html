<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="For a given vector of times, hazards.fun computes the estimated baseline hazard, cumulative baseline hazard, hazard, baseline survival, and survival functions. It can be used for prediction on a new sample."><title>Compute the estimated (baseline/cumulative) hazard and (baseline) survival functions — hazards.fun • BFI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the estimated (baseline/cumulative) hazard and (baseline) survival functions — hazards.fun"><meta property="og:description" content="For a given vector of times, hazards.fun computes the estimated baseline hazard, cumulative baseline hazard, hazard, baseline survival, and survival functions. It can be used for prediction on a new sample."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary" data-bs-theme="default"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BFI</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BFI.html">An Introduction to BFI</a>
    <a class="dropdown-item" href="../articles/Python.html">Calling BFI from Python</a>
    <a class="dropdown-item" href="../articles/SAS.html">Using BFI in SAS</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hassanpazira/BFI">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute the estimated (baseline/cumulative) hazard and (baseline) survival functions</h1>
      
      <div class="d-none name"><code>hazards.fun.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For a given vector of times, <code>hazards.fun</code> computes the estimated baseline hazard, cumulative baseline hazard, hazard, baseline survival, and survival functions. It can be used for prediction on a new sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hazards.fun</span><span class="op">(</span><span class="va">time</span>,</span>
<span>            z <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>            <span class="va">p</span>,</span>
<span>            <span class="va">theta_hat</span>,</span>
<span>            basehaz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weibul"</span>, <span class="st">"exp"</span>, <span class="st">"gomp"</span>, <span class="st">"poly"</span>, <span class="st">"pwexp"</span><span class="op">)</span>,</span>
<span>            <span class="va">q_max</span>,</span>
<span>            <span class="va">timax</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>time</dt>
<dd><p>the vector containing the time values for which the hazard rate is computed. If the argument <code>z</code> is not <code>NULL</code>, then the length of the argument <code>time</code> should be the number of columns of <code>z</code>, which is \(p\).</p></dd>


<dt>z</dt>
<dd><p>an new observation vector of length \(p\). If <code>z = NULL</code> (the default), then the relative risk (\(\bm z ^{\top}\bm \beta\)) is considered a vector of 1 with length \(n\).</p></dd>


<dt>p</dt>
<dd><p>the number of coefficients. It is equal to the number of elements of the argument <code>z</code>, if <code>z</code> is not <code>NULL</code>.</p></dd>


<dt>theta_hat</dt>
<dd><p>a vector contains the values of the estimated parameters. The first \(p\) values represent the coefficient parameters (\(\bm \beta\)), while the remaining values pertain to the parameters of the baseline hazard function  (\(\bm \omega\)).</p></dd>


<dt>basehaz</dt>
<dd><p>a character string representing one of the available baseline hazard functions; <code>exponential</code> (<code>"exp"</code>), <code>Weibull</code> (<code>"weibul"</code>, the default), <code>Gompertz</code> (<code>"gomp"</code>), <code>exponentiated polynomial</code> (<code>"poly"</code>), and <code>piecewise exponential</code> (<code>"pwexp"</code>).</p></dd>


<dt>q_max</dt>
<dd><p>a value represents the order of the exponentiated polynomial baseline hazard function. This argument should only be used when <code>basehaz = "poly"</code>. In the case of multiple centers, the maximum value of the orders should be used. <code><a href="BFI-internal.html">ql.LRT()</a></code> can be used for obtaining of the order of each center.</p></dd>


<dt>timax</dt>
<dd><p>a value represents the minimum (or maximum) value of the maximum times observed in the different centers. This argument should only be used when <code>basehaz = "pwexp"</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>hazards.fun</code> computes the estimated baseline hazard, cumulative baseline hazard, hazard, baseline survival, and survival functions at different time points specified in the argument <code>time</code>.</p>
<p>The function <code>hazards.fun()</code> can be used for prediction purposes with new sample. The arguments <code>time</code> and <code>z</code> should be provided for the new data.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    


<p><code>hazards.fun</code> returns a list containing the following components:</p>
<dl><dt>bhazard</dt>
<dd><p>the vector of estimates of the baseline hazard function at the time points given by the argument <code>time</code>;</p></dd>


<dt>cbhazard</dt>
<dd><p>the vector of estimates of the cumulative baseline hazard function at the time points specified in the argument <code>time</code>;</p></dd>


<dt>bsurvival</dt>
<dd><p>the vector of estimates of the baseline survival function at the time points given by the argument <code>time</code>;</p></dd>


<dt>hazard</dt>
<dd><p>the vector of estimates of the hazard function at the time points given by the argument <code>time</code>;</p></dd>


<dt>chazard</dt>
<dd><p>the vector of estimates of the cumulative hazard function at the time points specified in the argument <code>time</code>;</p></dd>


<dt>survival</dt>
<dd><p>the vector of estimates of the survival function at the time points given by the argument <code>time</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pazira H., Massa E., Weijers J.A.M., Coolen A.C.C. and Jonker M.A. (2024). <em>Bayesian Federated Inference for Survival Models</em>, <em>Statistics in Medicine</em>, 1-22. &lt;https://arxiv.org/abs/2404.17464&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Hassan Pazira<br>
Maintainer: Hassan Pazira <a href="mailto:hassan.pazira@radboudumc.nl">hassan.pazira@radboudumc.nl</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MAP.estimation.html">MAP.estimation</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Setting a seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Simulating Survival data</span></span></span>
<span class="r-in"><span><span class="co">##-------------------------</span></span></span>
<span class="r-in"><span><span class="va">Original_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">101</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, <span class="fl">101</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Original_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">X_new</span> <span class="op">&lt;-</span> <span class="va">Original_data</span><span class="op">[</span><span class="fl">101</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Simulating survival data from Exponential distribution</span></span></span>
<span class="r-in"><span><span class="co"># with a predefined censoring rate of 0.2:</span></span></span>
<span class="r-in"><span><span class="va">Original_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="surv.simulate.html">surv.simulate</a></span><span class="op">(</span>Z <span class="op">=</span> <span class="va">Original_data</span>, beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   cen_rate <span class="op">=</span> <span class="fl">0.2</span>, gen_data_from <span class="op">=</span> <span class="st">"exp"</span><span class="op">)</span><span class="op">$</span><span class="va">D</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Original_y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y_new</span> <span class="op">&lt;-</span> <span class="va">Original_y</span><span class="op">[</span><span class="fl">101</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>, length.out<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, family<span class="op">=</span><span class="st">'gaussian'</span><span class="op">)</span> <span class="co"># !!! "cox"</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Note that, if in 'X' there is a 'categorical' covariate with more than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 2 levels, then 'X' must be a 'data.frame' instead of a 'matrix'! </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Weibull baseline hazard</span></span></span>
<span class="r-in"><span><span class="co">#------------------------</span></span></span>
<span class="r-in"><span><span class="va">fit_weib</span> <span class="op">&lt;-</span> <span class="fu"><a href="MAP.estimation.html">MAP.estimation</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">'cox'</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>,</span></span>
<span class="r-in"><span>                           basehaz <span class="op">=</span> <span class="st">"weibul"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># reltive risk is 1:</span></span></span>
<span class="r-in"><span><span class="fu">hazards.fun</span><span class="op">(</span>time <span class="op">=</span> <span class="va">time_points</span>, p <span class="op">=</span> <span class="fl">10</span>, theta_hat <span class="op">=</span> <span class="va">fit_weib</span><span class="op">$</span><span class="va">theta_hat</span>,</span></span>
<span class="r-in"><span>            basehaz <span class="op">=</span> <span class="st">"weibul"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bhazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]      Inf 3.038750 2.985935 2.955467 2.934038 2.917524 2.904100 2.892798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 2.883044 2.874467 2.866816 2.859913 2.853625 2.847854 2.842520 2.837564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 2.832935 2.828594 2.824508 2.820647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cbhazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.000000  1.540697  3.027837  4.495413  5.950425  7.396166  8.834562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 10.266877 11.694009 13.116623 14.535236 15.950259 17.362027 18.770819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 20.176870 21.580381 22.981525 24.380454 25.777302 27.172187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bsurvival</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.000000e+00 2.142318e-01 4.842024e-02 1.116007e-02 2.604733e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 6.136008e-04 1.456125e-04 3.476577e-05 8.343660e-06 2.011514e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] 4.868861e-07 1.182744e-07 2.882487e-08 7.045905e-09 1.727017e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 4.243848e-10 1.045324e-10 2.580498e-11 6.383519e-12 1.582228e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]      Inf 3.038750 2.985935 2.955467 2.934038 2.917524 2.904100 2.892798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 2.883044 2.874467 2.866816 2.859913 2.853625 2.847854 2.842520 2.837564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 2.832935 2.828594 2.824508 2.820647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $chazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  0.000000  1.540697  3.027837  4.495413  5.950425  7.396166  8.834562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 10.266877 11.694009 13.116623 14.535236 15.950259 17.362027 18.770819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 20.176870 21.580381 22.981525 24.380454 25.777302 27.172187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $survival</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.000000e+00 2.142318e-01 4.842024e-02 1.116007e-02 2.604733e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] 6.136008e-04 1.456125e-04 3.476577e-05 8.343660e-06 2.011514e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] 4.868861e-07 1.182744e-07 2.882487e-08 7.045905e-09 1.727017e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 4.243848e-10 1.045324e-10 2.580498e-11 6.383519e-12 1.582228e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Gompertz baseline hazard</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------</span></span></span>
<span class="r-in"><span><span class="va">fit_gomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="MAP.estimation.html">MAP.estimation</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">'cox'</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>,</span></span>
<span class="r-in"><span>                           basehaz <span class="op">=</span> <span class="st">"gomp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># different time points</span></span></span>
<span class="r-in"><span><span class="fu">hazards.fun</span><span class="op">(</span>time<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">10</span>, theta_hat <span class="op">=</span> <span class="va">fit_gomp</span><span class="op">$</span><span class="va">theta_hat</span>,</span></span>
<span class="r-in"><span>            basehaz <span class="op">=</span> <span class="st">"gomp"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bhazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   3.393849   4.279803   5.397032   6.805911   8.582572  10.823026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  13.648343  17.211200  21.704130  27.369926  34.514759  43.524729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  54.886723  69.214730  87.283018 110.067976 138.800877 175.034411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cbhazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   3.029005   6.848723  11.665565  17.739830  25.399762  35.059295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  47.240420  62.601388  81.972290 106.399904 137.204271 176.050021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 225.036333 286.810368 364.710321 462.945813 586.825373 743.043303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bsurvival</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  4.836373e-02  1.060810e-03  8.584389e-06  1.975558e-08  9.311585e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6]  5.942122e-16  3.046116e-21  6.494752e-28  2.511233e-36  6.181712e-47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]  2.587869e-60  3.486962e-77  1.853371e-98 2.753213e-125 4.058074e-159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 8.814301e-202 1.396300e-255 1.976263e-323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   3.393849   4.279803   5.397032   6.805911   8.582572  10.823026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  13.648343  17.211200  21.704130  27.369926  34.514759  43.524729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13]  54.886723  69.214730  87.283018 110.067976 138.800877 175.034411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $chazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   3.029005   6.848723  11.665565  17.739830  25.399762  35.059295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7]  47.240420  62.601388  81.972290 106.399904 137.204271 176.050021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 225.036333 286.810368 364.710321 462.945813 586.825373 743.043303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $survival</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  4.836373e-02  1.060810e-03  8.584389e-06  1.975558e-08  9.311585e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6]  5.942122e-16  3.046116e-21  6.494752e-28  2.511233e-36  6.181712e-47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11]  2.587869e-60  3.486962e-77  1.853371e-98 2.753213e-125 4.058074e-159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] 8.814301e-202 1.396300e-255 1.976263e-323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###----------------------------</span></span></span>
<span class="r-in"><span><span class="co">### Prediction for a new sample</span></span></span>
<span class="r-in"><span><span class="co">###----------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Exponentiated polynomial baseline hazard</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, family<span class="op">=</span><span class="st">'gaussian'</span><span class="op">)</span> <span class="co"># !!! "cox"</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Note that, if in 'X' there is a 'categorical' covariate with more than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 2 levels, then 'X' must be a 'data.frame' instead of a 'matrix'! </span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="b.diag.html">b.diag</a></span><span class="op">(</span><span class="va">Lambda</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co">#! omit</span></span></span>
<span class="r-in"><span><span class="va">fit_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="MAP.estimation.html">MAP.estimation</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family <span class="op">=</span> <span class="st">'cox'</span>, Lambda <span class="op">=</span> <span class="va">Lambda</span>,</span></span>
<span class="r-in"><span>                           basehaz <span class="op">=</span> <span class="st">"poly"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hazards.fun</span><span class="op">(</span>time <span class="op">=</span> <span class="va">y_new</span><span class="op">$</span><span class="va">time</span>, z <span class="op">=</span> <span class="va">X_new</span>, theta_hat <span class="op">=</span> <span class="va">fit_poly</span><span class="op">$</span><span class="va">theta_hat</span>,</span></span>
<span class="r-in"><span>            basehaz <span class="op">=</span> <span class="st">"poly"</span>, q_max <span class="op">=</span> <span class="va">fit_poly</span><span class="op">$</span><span class="va">q_l</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bhazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.143552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cbhazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1795623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bsurvival</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8356358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.396765</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $chazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4796303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $survival</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6190122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Piecewise Exponential baseline hazard</span></span></span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="inv.prior.cov.html">inv.prior.cov</a></span><span class="op">(</span><span class="va">X</span>, lambda<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, family<span class="op">=</span><span class="st">'gaussian'</span><span class="op">)</span> <span class="co"># !!! "cox"</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Note that, if in 'X' there is a 'categorical' covariate with more than</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 2 levels, then 'X' must be a 'data.frame' instead of a 'matrix'! </span>
<span class="r-in"><span><span class="va">Lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="b.diag.html">b.diag</a></span><span class="op">(</span><span class="va">Lambda</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span> <span class="co">#! omit</span></span></span>
<span class="r-in"><span><span class="va">fit_pw</span> <span class="op">&lt;-</span> <span class="fu"><a href="MAP.estimation.html">MAP.estimation</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">X</span>, family<span class="op">=</span><span class="st">'cox'</span>, Lambda<span class="op">=</span><span class="va">Lambda</span>, basehaz<span class="op">=</span><span class="st">"pwexp"</span>,</span></span>
<span class="r-in"><span>                         min_max_times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  No. observations in the intervals :  83 11 4 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-in"><span><span class="fu">hazards.fun</span><span class="op">(</span>time <span class="op">=</span> <span class="va">y_new</span><span class="op">$</span><span class="va">time</span>, z <span class="op">=</span> <span class="va">X_new</span>, theta_hat <span class="op">=</span> <span class="va">fit_pw</span><span class="op">$</span><span class="va">theta_hat</span>,</span></span>
<span class="r-in"><span>            basehaz <span class="op">=</span> <span class="st">"pwexp"</span>, timax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bhazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.023736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cbhazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1727183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bsurvival</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8413746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.119203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $chazard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4637757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $survival</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6289046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hassan Pazira, Emanuele Massa, Marianne A. Jonker.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

